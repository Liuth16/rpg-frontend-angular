<main class="play-layout">
  <!-- Left side: Past Campaigns -->
  <section class="left-panel details-background">
    <header class="panel-header">
      <h2 class="text-lg font-bold p-2">Past Campaigns</h2>
    </header>
    <div class="panel-content overflow-y-auto p-4">
      @if (campaigns().length === 0) {
      <p>No past campaigns found.</p>
      } @for (camp of campaigns(); track camp.id) {
      <p-card class="character-card mb-4">
        <ng-template pTemplate="header">
          <div class="flex items-center p-4 gap-3">
            <div class="text-xl font-semibold">{{ camp.campaign_name }}</div>
          </div>
        </ng-template>
        <p><strong>Mode:</strong> {{ camp.mode }}</p>
        <p><strong>Character:</strong> {{ camp.character.name }}</p>
        <ng-template pTemplate="footer">
          <div class="flex justify-center align-center gap-2">
            <button
              pButton
              type="button"
              label="View"
              class="cursor-pointer w-32 blz-button"
              (click)="selectCampaign(camp.id)"
            ></button>
            <button
              pButton
              type="button"
              label="Delete Campaign"
              class="cursor-pointer blz-button"
              (click)="confirmDelete(camp.id)"
            ></button>
          </div>
        </ng-template>
      </p-card>
      }
    </div>
  </section>

  <!-- Right side: Chat -->
  <div class="right-panel flex flex-col gap-4">
    @if (selectedCampaign()) {
    <section class="right-panel details-background">
      <header class="panel-header">
        <h2 class="text-lg font-bold p-2">Chat</h2>
      </header>

      <div class="chat-log flex-1 overflow-y-auto p-4 flex flex-col gap-4" #chatContainer>
        @for (turn of turns(); track turn.id) {
        <div class="p-2 border-b border-gray-700">
          <div class="text-blue-600 mb-1"><strong>You:</strong> {{ turn.user_input }}</div>
          <div class="text-green-600 mb-1"><strong>Narrative:</strong> {{ turn.narrative }}</div>

          <!-- Effects -->
          @if (turnEffects(turn).length > 0) {
          <div class="ml-4 mt-1 text-sm text-red-600">
            @for (eff of turnEffects(turn); track $index) {
            <div>⚔️ {{ eff }}</div>
            }
          </div>
          }

          <!-- Rewards -->
          @if (turnRewards(turn).length > 0) {
          <div class="ml-4 mt-1 text-sm text-yellow-600">
            @for (reward of turnRewards(turn); track $index) {
            <div>{{ reward }}</div>
            }
          </div>
          }
        </div>
        }
      </div>
    </section>
    }
  </div>
</main>

<p-confirmDialog></p-confirmDialog>
