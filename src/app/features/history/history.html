<main class="history-layout">
  <!-- Left side: Past Campaigns -->
  <section class="campaigns-list details-background">
    <header class="panel-header">
      <h2 class="panel-title">Campanhas Passadas</h2>
    </header>
    <div class="campaigns-scroll">
      @if (campaigns().length === 0) {
      <div class="empty-state">
        <p class="empty-text">Nenhuma campanha passada.</p>
        <p class="empty-hint">Complete suas aventuras para v√™-las aqui!</p>
      </div>
      } @for (camp of campaigns(); track camp.id) {
      <div class="campaign-card" [class.selected]="selectedCampaign()?.id === camp.id">
        <div class="campaign-header">
          <h3 class="campaign-name">{{ camp.campaign_name }}</h3>
          <span class="campaign-mode">{{ camp.mode }}</span>
        </div>

        <div class="campaign-info">
          @if (camp.character?.name) {
          <div class="info-row">
            <span class="info-icon">üé≠</span>
            <span class="info-text">{{ camp.character.name }}</span>
          </div>
          }
        </div>

        <div class="campaign-actions">
          <button
            pButton
            type="button"
            label="Ver Hist√≥ria"
            class="action-btn view-btn"
            (click)="selectCampaign(camp.id)"
          ></button>
          <button
            pButton
            type="button"
            label="Excluir"
            icon="pi pi-trash"
            class="action-btn delete-btn"
            (click)="confirmDelete(camp.id)"
          ></button>
        </div>
      </div>
      }
    </div>
  </section>

  <!-- Right side: Chat History -->
  @if (selectedCampaign()) {
  <section class="chat-history details-background">
    <header class="panel-header">
      <div class="header-content">
        <div>
          <h2 class="panel-title">{{ selectedCampaign().name }}</h2>
          @if (selectedCampaign().character?.name) {
          <p class="campaign-subtitle">
            {{ selectedCampaign().character.name }} ‚Ä¢ Modo: {{ selectedCampaign().mode }}
          </p>
          } @else {
          <p class="campaign-subtitle">Modo: {{ selectedCampaign().mode }}</p>
          }
        </div>
      </div>
    </header>

    <div class="chat-log" #chatContainer>
      @if (turns().length === 0) {
      <div class="empty-state">
        <p class="empty-text">Nenhum hist√≥rico dispon√≠vel.</p>
      </div>
      } @else { @for (turn of turns(); track turn.id) {
      <div class="turn-entry">
        <div class="user-message"><strong>Voc√™:</strong> {{ turn.user_input }}</div>
        <div class="narrative-message"><strong>Narrativa:</strong> {{ turn.narrative }}</div>

        <!-- Effects -->
        @if (turnEffects(turn).length > 0) {
        <div class="effects-list">
          @for (eff of turnEffects(turn); track $index) {
          <div class="effect-item">‚öîÔ∏è {{ eff }}</div>
          }
        </div>
        }

        <!-- Rewards -->
        @if (turnRewards(turn).length > 0) {
        <div class="rewards-list">
          @for (reward of turnRewards(turn); track $index) {
          <div class="reward-item">{{ reward }}</div>
          }
        </div>
        }
      </div>
      } }
    </div>
  </section>
  }
</main>

<p-confirmDialog></p-confirmDialog>
